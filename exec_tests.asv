classdef exec_tests < matlab.unittest.TestCase
    
    %NB i test  vanno in ordine!
    properties
        f
        x0
        TOL
        NMAX
    end
    
    methods
        
        
        function obj=exec_tests(f,x0,TOL,NMAX)
            
            if(nargin==4)
                obj.f =f;
                obj.x0=x0;
                obj.TOL=TOL;
                obj.NMAX=NMAX;
            else if (nargin==3)
                    obj.f =f;
                    obj.x0=x0;
                    obj.TOL=TOL;
                else if(nargin==2)
                        obj.f =f;
                        obj.x0=x0;
                    else (nargin==1)
                        obj.f =f;
                    end
                    
                end
            end
        end
    end
    
    methods(Test)
        function TestCase11(testCase)
            %Caso 11 : Verifica se la funzione non ï¿½ presente
            %Richiamo i parametri
            
            %Ho problemi ad implementarla nel test
            verifyNotEmpty(testCase,testCase.f);
        end
         
        function TestCase10(testCase)
            %Caso 10 : Verifica se la funzione ï¿½ Handle
            
            %SI DEVE IMPLEMENTARE COME CONTROLLO SU F NEL PROGRAMMA
            %PRINCIPALE
            if(isa(testCase.f,'function_handle'))
                %passato
                verifyReturnsTrue(testCase,@true);
            else
                %non passato
                verifyReturnsTrue(testCase,@false);
            end
        end
        
        function TestCase3(testCase)
            %verifica l'errore nel caso in cui entrambi i valori
            %dell'intervallo sono vuoti
            
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:IntevalloVuoto');
            
            verifyReturnsTrue(testCase,@true);
            
            
        end 
        
         function TestCase2(testCase)
            %verifica l'errore nel caso in cui il primo estremo o il secondo estremo dell'intervallo inserito
            %non ï¿½ un numero
            
            
            testCase.x0(1)
            testCase.x0(2)
            testCase.TOL
            testCase.NMAX
            testCase.f
            
            
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:NonèunNumero');
            
            
         end
         
         function TestCase5(testCase)
            %verifica l'errore nel caso in cui i valori dell'intervallo non
            %sono validi, poichï¿½ o inseriamo un numero di elementi diverso
            %da 2 come lunghezza dell'intervallo
            %DA TOGLIERE O RIMANERE COSI
            
            if(length(testCase.x0)~=2)
                verifyReturnsTrue(testCase,@false);
            else
                verifyReturnsTrue(testCase,@true);
            end
            
         end
        
        function TestCase4(testCase)
            %verifica l'errore nel caso in cui entrambi i valori
            %dell'intervallo sono uguali
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:EstremiIntervallo');
            
            
        end
        
        function TestCase6(testCase)
            %verifica l'errore nel caso in cui non ï¿½ soddisfatto il teorema
            %degli zeri
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:TeoremaDegliZeriNonSoddisfatto');
            
            
        end
        
         function TestCase9(testCase)
            %Il test non passa se la tolleranza non ï¿½ inserita dall'utente
            
            verifyWarning(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'WARN:TolleranzaNonInserita');
            
         end
         function TestCase16(testCase)
            %Il test non passa se la tolleranza inserita dall'utente è
            %minore di eps
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:TolleranzaMINESP');
            
            
        end
        
        function TestCase17(testCase)
            %Il test non passa se la tolleranza inserita dall'utente non è
            %un numero
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:TolleranzaNumReale');
            
        end
        
        function TestCase1(testCase)
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:Superato il numero massimo di Iterazioni-SOluzione non determinata' );
            
        end
        
       
        
        
        
        
        
        
        
        
       
        
        
        
        function TestCase7(testCase)
            %verifica se l'accuratezza ï¿½ adeguata con TOL=eps
            
            [x, ~, ~]= algoritmo_di_bisezione(testCase.f,testCase.x0);
            actSolution=x;
            expSolution= fzero(testCase.f,testCase.x0);
            abs_error = abs(actSolution - expSolution)/abs(expSolution);
            verifyLessThan(testCase,abs_error,eps*max(actSolution,expSolution),'Risultato poco accurato');
            %FATTA BENE forse poco utile
        end
        
        function TestCase8(testCase)
            %verifica se l'accuratezza ï¿½ adeguata con TOL inserito da Utente
            
            [x, ~, ~]= algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL);
            actSolution=x;
            options = optimset('TolX',testCase.TOL);
            expSolution=fzero(testCase.f,testCase.x0,options);
            abs_error = abs(actSolution - expSolution)/abs(expSolution);
            verifyLessThan(testCase,abs_error,eps*max(actSolution,expSolution),'Risultato poco accurato');
            %FATTA BENE
        end
        
       
        
        
        
       
        
       
        function TestCase12(testCase)
            %Caso 12 : Verifica se il valore di NMAX
            %non ï¿½ numerico, non ï¿½ scalare, ï¿½ infinito
            %oppure ï¿½ NaN
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:NMAXINTEROPOsitivo');
            
            
        end
        
        function TestCase13(testCase)
            %Caso 13 : Verifica se il valore di NMAX
            %ï¿½ minore o uguale a 0
            %Richiamo i parametri
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'Err:NMAXINTEROPOsitivo');
        end
        
        function TestCase14(testCase)
            %Caso 14 : Verifica se il valore di NMAX
            %ï¿½ minore o uguale a 2
            %Richiamo i parametri
            
            verifyError(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX), 'Err:NMAXI<2');
            
        end
        
        function TestCase15(testCase)
            %Caso 15 : Verifica se il valore di NMAX
            %ï¿½ maggiore o uguale a 1000
            
            
            verifyWarning(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX), 'WARN:NMAXI>1000');
            
        end
        
       
        function TestCase18(testCase)
            
            verifyWarning(testCase,@()algoritmo_di_bisezione(testCase.f,testCase.x0,testCase.TOL,testCase.NMAX),'WARN:Numero di iterazioni alte,prestazioni non ottimali');
            
        end
        
    end
    
    
end



